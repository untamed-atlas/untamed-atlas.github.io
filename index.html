<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Untamed atlas</title>
    <meta name="description" content="Untamed: Unconstrained Tensor Decomposition and Graph Node Embedding for Cortical Parcellation">

    <link rel="icon" type="image/png" href="./index_files/icon.png">
    <link rel="stylesheet" href="./index_files/bootstrap.min.css">
    <link rel="stylesheet" href="./index_files/font-awesome.min.css">
    <link rel="stylesheet" href="./index_files/codemirror.min.css">
    <link rel="stylesheet" href="./index_files/app.css">
    <link rel="stylesheet" href="./index_files/bootstrap.min(1).css">

    <!-- Visualization libraries -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/MTLLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/OBJLoader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.4.4/math.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/3.1.0/openseadragon.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/3.1.0/openseadragon.min.css">

    <script src="./index_files/jquery.min.js"></script>
    <script src="./index_files/bootstrap.min.js"></script>
    <script src="./index_files/codemirror.min.js"></script>
    <script src="./index_files/clipboard.min.js"></script>
    <script src="./index_files/app.js"></script>
</head>

<body>
    <div class="container" id="main">
        <div class="row">
            <h1 class="col-md-12 text-center" style="margin-top: 50px; font-size: 2.0em; font-weight: 400;">
                Untamed: Unconstrained Tensor Decomposition <br> and Graph Node Embedding for Cortical Parcellation
                </span>
                <br /><br />
            </h1>
        </div>

        <!-- Authors section -->
        <div class="row">
            <div class="col-md-12 text-center">
                <ul class="list-inline">
                    <li><a href="https://perfectroc.com">Yijun Liu</a><sup>1</sup></li>
                    <li><a href="https://silencer1127.github.io/">Jian (Andrew) Li</a><sup>2, 3</sup></li>
                    <li><a href="https://scholar.google.com/citations?user=Nw_WblYAAAAJ&hl=en&oi=ao">Jessica L. Wisnowski</a><sup>4, 5</sup></li>
                    <li><a href="https://scholar.google.com/citations?user=UUTFsUAAAAAJ&hl=en&oi=ao">Richard M. Leahy</a><sup>1</sup></li>
                </ul>
            </div>
        </div>

        <!-- Affiliations section -->
        <div class="row">
            <div class="col-md-12 text-center">
                <ul class="list-inline">
                    <li><sup>1</sup>Ming Hsieh Department of Electrical and Computer Engineering, University of Southern California</li>
                    <br>
                    <li><sup>2</sup>Athinoula A. Martinos Center for Biomedical Imaging, Massachusetts General Hospital and Harvard Medical School</li>
                    <br>
                    <li><sup>3</sup>Center for Neurotechnology and Neurorecovery, Department of Neurology, Massachusetts General Hospital and Harvard Medical School</li>
                    <br>
                    <li><sup>4</sup>Radiology and Pediatrics, Division of Neonatology, Children's Hospital Los Angeles</li>
                    <br>
                    <li><sup>5</sup>Keck School of Medicine, University of Southern California</li>
                </ul>
            </div>
        </div>

        <!-- Navigation section -->
        <div class="row">
            <div class="col-md-8 col-md-offset-2 text-center">
                <ul class="nav nav-pills nav-justified">
                    <li>
                        <a href="https://untamed-atlas.github.io/" target='_blank'>
                            <img src="./index_files/images/paper.png" height="80px"><br>
                            <h4><strong>Manuscript</strong></h4>
                        </a>
                    </li>
                    <li>
                        <a href="https://doi.org/10.6084/m9.figshare.24750117.v2" target='_blank'>
                            <img src="./index_files/images/atlas_image.png" height="80px"><br>
                            <h4><strong>Atlases</strong></h4>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/snapfinger/Untamed">
                            <img src="./index_files/images/github_pad.png" height="80px"><br>
                            <h4><strong>Code</strong></h4>
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Introduction Section -->
        <div class="row" style="margin-top: 40px;">
            <div class="col-md-8 col-md-offset-2">
                <h2><center>Introduction</center></h2>
                <div style="margin-top: 20px; line-height: 1.6; text-align: justify;">
                    <p>
                        Untamed is a fully automated framework for cortical parcellation that bridges large-scale network identification and region-level parcellation from resting-state fMRI. It integrates unconstrained tensor decomposition via NASCAR, without relying on strong assumptions like statistical independence, with graph-based node embeddings to generate spatially coherent, functionally homogeneous cortical regions. Compared to existing atlases, Untamed delivers superior or comparable performance in functional connectivity homogeneity and task alignment across multiple datasets.
                    </p>
                </div>
            </div>
        </div>

        <!-- Framework Image -->
        <div class="row" style="margin-top: 40px;">
            <div class="col-md-8 col-md-offset-2">
                <h3><center>Framework</center></h3>
                <div style="border: 2px dotted #999; padding: 20px; display: inline-block; width: 100%;">
                    <img src="./index_files/images/untamed_framework.jpg" class="img-responsive" alt="Untamed Framework" style="width: 100%;">
                </div>
            </div>
        </div>

        <!-- Performance Section -->
        <div class="row" style="margin-top: 40px;">
            <div class="col-md-8 col-md-offset-2">
                <h2><center>Performance</center></h2>
                
                <!-- RSFC Homogeneity Visualization -->
                <div style="margin-top: 30px;">
                    <h3><center>Resting-state functional connectivity (RSFC)homogeneity</center></h3>
                    <p class="text-center" style="color: #666; margin-top: -10px; margin-bottom: 20px;">
                        <small><i>Note: Higher values indicate better homogeneity</i></small>
                    </p>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <ul class="nav nav-tabs" role="tablist" style="border-bottom: none;">
                                <li role="presentation" class="active">
                                    <a href="#yale" role="tab" data-toggle="tab" onclick="loadImage('yale', 'rsfc')" 
                                       style="border: none; color: #333; font-weight: 500;">
                                        Yale
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a href="#hcp" role="tab" data-toggle="tab" onclick="loadImage('hcp', 'rsfc')"
                                       style="border: none; color: #333; font-weight: 500;">
                                        HCP
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="panel-body" style="padding: 0;">
                            <div id="rsfc-viewer" style="height: 600px; width: 100%;"></div>
                            <p class="text-muted" style="font-size: 0.97em; margin-top: -40px; text-align: justify; line-height: 1.6;">
                                Weighted average RSFC homogeneity on the Yale / HCP dataset. Each bar plot depicts the subject-wise RSFC weighted average homogeneity, averaged across test subjects, for each baseline and the Untamed atlas, with matched parcel numbers for the left and right hemispheres. The error bars represent the standard error across all subjects. 
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Task Contrast Alignment Visualization -->
                <div style="margin-top: 40px;">
                    <h3><center>Task contrast alignment</center></h3>
                    <p class="text-center" style="color: #666; margin-top: -10px; margin-bottom: 20px;">
                        <small><i>Note: Lower values indicate better alignment</i></small>
                    </p>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <ul class="nav nav-tabs" role="tablist" style="border-bottom: none;">
                                <li role="presentation" class="active">
                                    <a href="#mdtb-task" role="tab" data-toggle="tab" onclick="loadImage('mdtb', 'task')" 
                                       style="border: none; color: #333; font-weight: 500;">
                                        MDTB
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a href="#hcp-task" role="tab" data-toggle="tab" onclick="loadImage('hcp', 'task')"
                                       style="border: none; color: #333; font-weight: 500;">
                                        HCP
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="panel-body" style="padding: 0;">
                            <div id="task-viewer" style="height: 600px; width: 100%;"></div>
                            <p class="text-muted" style="font-size: 0.97em; margin-top: -40px; text-align: justify; line-height: 1.6;">
                                Weighted average task contrast variance evaluated on MDTB / HCP test subjects. Each violin plot depicts the alignment with task contrast maps, computed for the baseline and the Untamed atlas, with matched parcel numbers for the left and right hemispheres.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ablation Studies Section -->
        <div class="row" style="margin-top: 40px;">
            <div class="col-md-8 col-md-offset-2">
                <h2><center>Selected ablation study</center></h2>
                
                <!-- Input Feature Map Study -->
                <div style="margin-top: 30px;">
                    <h3><center>Input spatial feature map: NASCAR vs ICA</center></h3>
                    <div style="border: 2px dotted #999; padding: 20px; display: inline-block; width: 100%;">
                        <img src="./index_files/images/ablation_ica_vs_nascar.png" class="img-responsive" alt="NASCAR vs ICA Comparison" style="width: 100%; display: block; margin: 0 auto;" />
                        <p class="text-muted" style="font-size: 0.97em; margin-top: 5px; text-align: justify; line-height: 1.6;">
                            Weighted average RSFC homogeneity on the HCP dataset. Each bar plot depicts the subject-wise RSFC weighted average homogeneity, averaged across test subjects, for each atlas generated from ICA maps and the Untamed atlas (generated from NASCAR maps). Parcel numbers matched for the left and right hemispheres. The error bars represent the standard error across all subjects. The ICA baselines, derived from and optimized through hyperparameter tuning on the same HCP dataset, benefit from this dataset-specific tuning. In contrast, the Untamed atlas was generated using the independent GSP dataset with hyperparameters tuned on GSP. The ICA results represent the maximum homogeneity achievable under optimal hyperparameter settings for the HCP dataset.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <style>
            .nav-tabs > li > a {
                margin-right: 2px;
                line-height: 1.42857143;
                border: none;
                border-radius: 4px 4px 0 0;
                padding: 10px 20px;
            }
            .nav-tabs > li.active > a,
            .nav-tabs > li.active > a:hover,
            .nav-tabs > li.active > a:focus {
                color: #337ab7;
                background-color: #fff;
                border: none;
                border-bottom: 2px solid #337ab7;
            }
            .nav-tabs > li > a:hover {
                border-color: transparent;
                background-color: #f5f5f5;
            }
            .panel {
                border: 1px solid #ddd;
                border-radius: 4px;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            .panel-heading {
                background-color: #f8f8f8;
                border-bottom: 1px solid #ddd;
                padding: 0;
            }
            /* Minimize gap between ablation viewer and caption */
            #ablation-viewer, #ablation-viewer > div, #ablation-viewer canvas {
                margin-bottom: 0 !important;
                padding-bottom: 0 !important;
            }
            #ablation-viewer + .text-muted {
                margin-top: -50px !important;
            }
        </style>

        <script>
            // Initialize OpenSeadragon viewers
            const rsfcViewer = OpenSeadragon({
                id: "rsfc-viewer",
                prefixUrl: "https://cdnjs.cloudflare.com/ajax/libs/openseadragon/3.1.0/images/",
                showNavigationControl: true,
                showRotationControl: true,
                showHomeControl: true,
                showFullPageControl: true,
                maxZoomLevel: 10,
                minZoomLevel: 0.5,
                visibilityRatio: 1,
                defaultZoomLevel: 1,
                animationTime: 0.5
            });

            const taskViewer = OpenSeadragon({
                id: "task-viewer",
                prefixUrl: "https://cdnjs.cloudflare.com/ajax/libs/openseadragon/3.1.0/images/",
                showNavigationControl: true,
                showRotationControl: true,
                showHomeControl: true,
                showFullPageControl: true,
                maxZoomLevel: 10,
                minZoomLevel: 0.5,
                visibilityRatio: 1,
                defaultZoomLevel: 1,
                animationTime: 0.5
            });

            // Function to load images
            function loadImage(type, section) {
                const viewer = section === 'rsfc' ? rsfcViewer : taskViewer;
                let imagePath;
                
                if (section === 'rsfc') {
                    imagePath = type === 'yale' ? 
                        './index_files/images/homo_yale_new.png' : 
                        './index_files/images/homo_hcp_new.png';
                } else { // task contrast
                    imagePath = type === 'mdtb' ? 
                        './index_files/images/task_mdtb_new.png' : 
                        './index_files/images/task_hcp_new.png';
                }
                
                viewer.open({
                    type: 'image',
                    url: imagePath
                });

                // Update active tab
                const tabPrefix = section === 'rsfc' ? '' : '-task';
                $('.nav-tabs li').removeClass('active');
                $(`a[href="#${type}${tabPrefix}"]`).parent().addClass('active');
            }

            // Load default images
            loadImage('yale', 'rsfc');
            loadImage('yale', 'task');

            // Add click interaction
            [rsfcViewer, taskViewer].forEach(viewer => {
                viewer.addHandler('canvas-click', function(event) {
                    const webPoint = event.position;
                    const viewportPoint = viewer.viewport.pointFromPixel(webPoint);
                    console.log('Clicked at:', viewportPoint);
                });
            });
        </script>
    </div>
</body>
</html>
